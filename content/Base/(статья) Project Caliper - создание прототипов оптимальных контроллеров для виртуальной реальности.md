202202210712
***
[[(VR) VR-переферия]]
***
[ссылка](https://skarredghost.com/2021/12/08/project-caliper-prototyping-controllers-vr/)
***
# Project Caliper - создание прототипов оптимальных контроллеров для виртуальной реальности
![[Pasted image 20220221071320.png]]
Сегодня в Италии особый день, когда семьи готовят рождественскую елку, поэтому я решил опубликовать особенный пост, который станет большим подарком всему сообществу XR. Но подарок не мой, а эксперта по эргономике XR Роба Коула, который написал НЕВЕРОЯТНЫЙ гостевой пост о своих экспериментах по созданию с нуля прототипа контроллера SteamVR с модульной конструкцией и оптимальной эргономикой. Пост очень длинный, но очень интересный, особенно если вы занимаетесь рукоделием или любите вещи своими руками.

Роб любит исследовать технологию, всегда начиная с точки зрения человека, *ставя человека в центр своих экспериментов и анализа*, и он делал это также во время работы над *проектом Caliper, его экспериментом по созданию улучшенной версии контроллеров индекса Valve в одиночку в его Свободное время*. Я думаю, что окончательный результат этого поста довольно интригующий, и я приглашаю всех вас связаться с Робом через Twitter или по электронной почте (попросив меня представиться), чтобы обсудить с ним возможное сотрудничество (или финансирование?). Я даже надеюсь, что некоторые крупные бренды смогут вдохновиться некоторыми функциями, которые он представил в контроллерах Caliper.

Тем не менее, приглашаю вас поддержать этот блог на Patreon, чтобы я мог продолжать размещать эти замечательные статьи, я оставляю вас на пост Роба, который похож на крошечную книгу о пути разработки *Project Caliper*. Наслаждайтесь чтением

![[Pasted image 20220221071830.png]]
***
# Введение
После моей статьи о [Tundra SteamVR HDK](https://skarredghost.com/2021/03/31/tundra-labs-hdk-steamvr/), опубликованной Skarredghost ранее в этом году, *я приступил к разработке нового контроллера движения, запустив стартап Immersion Mechanics*. Используя свой опыт в промышленном дизайне, многолетний опыт в области эргономики, а также последние пять лет, потраченные на оценку и взлом XR-оборудования, я решил попробовать.

Следуя мудрому совету *«не бросай основную работу»*, я продолжал работать полный рабочий день, управляя центром технического обслуживания для глобального производителя в несвязанной отрасли. Это оказалось невероятно полезным, предоставив мне круглосуточный доступ к полностью оборудованным сервисным мастерским, а также безопасное открытое пространство для распыления краски или работы с клеями и пластмассами.

Найти баланс между работой на полный рабочий день и попытками найти как можно больше свободных часов для развития и при этом найти время для семьи оказалось очень сложно. *Я быстро понял, что нужно отложить как минимум 3 часа, чтобы сделать что-то значимое, в противном случае вам нужно закончить*, как только вы начнете.

Идти в мастерскую в 4 утра, чтобы вырезать деревянные формы для захвата, проводить свой выходной за лепкой из пластика или изучать Blender в 5 утра, было действительно сложно. *Требовалась твердая дисциплина, чтобы продолжать двигаться вперед,* так как было слишком легко расслабиться, работая слишком редко, чтобы добиться реального прогресса.

![[Pasted image 20220221072951.png]]

Атмосфера «дня сурка» во время изоляции во время пандемии заставила дни слиться воедино… наш объект был классифицирован как служба первой необходимости, поэтому мы оставались открытыми, давая мне постоянный доступ к семинарам, но за счет очень долгой работы. часов, в то время как многие стояли дома в оплачиваемом отпуске.

Изначально я планировал вложить свои деньги в создание работающего прототипа, а затем искать дополнительные средства, чтобы вывести на потребительский рынок *мой новый контроллер SteamVR «Caliper»* вместе с контроллерами Index и Wand; но, к сожалению, *у Мира были другие планы.*

# Локдаун и дефицит

Продолжающееся воздействие Covid, огромный спрос на электронику, нехватка рабочей силы, отключение электроэнергии в Китае, приводящее к трехдневной работе на заводах, и продолжающаяся лотерея контейнерных перевозок нарушили многие линии поставок «как раз вовремя». *Это привело к длительным задержкам производства и нехватке компонентов,* особенно для кремниевых процессоров, используемых во всем, от электромобилей и смартфонов до игровых консолей и оборудования виртуальной реальности.

Недавно Valve объявила о задержке выпуска своего нового портативного устройства Steam Deck, в то время как Megadodo Games объявила об отложенном ограниченном выпуске своего DecaGear, прежде чем полностью уйти с рынка оборудования. Новые консоли PlayStation и Xbox по-прежнему очень слабы, в то время как нехватке видеокарт для ПК не видно конца, а геймеры по-прежнему страдают от завышенных цен на продукты Nvidia и AMD. *Не удалось даже купить еще один Tundra HDK, а спустя месяцы их все еще нет в наличии.*

Даже такие крупные игроки, как Sony, Apple и Microsoft, существенно сократили свои прогнозы производства на 2022 год, в то время как *производители процессоров говорят о переносе на 2024 год.* оградить свой бизнес от дальнейших потрясений.

Эта проблема затрагивает всех, от стартапов до хорошо зарекомендовавших себя игроков с глубокими карманами; как независимый разработчик аппаратного обеспечения, быстро прожигающий свои деньги, *я должен был принять трудное решение в середине этого года, решив остановиться, прежде чем я углублюсь в ситуацию, которая становилась безвыходной.*

Финансовая реальность разработки аппаратного обеспечения быстро стала очевидной; *было очень легко потратить огромные суммы денег на планирование, разработку и подготовку к производству, прежде чем даже сделать что-то для продажи.* Выбрасывать тысячи на попытку, которая вряд ли увенчается успехом, начинало походить на мрачную реальность, я не хотел быть еще одной из этих историй…

*Только регистрация лицензии PID (требуемой для любого нового USB-устройства) стоила всего 5000 фунтов стерлингов;* стоимость нестандартных гибких кабелей, печатных плат и инструментов для литья под давлением означала перезакладывание дома, в то время как лицензирование технологии тактильных ощущений Immersion Corporation было недешевым.

*Люди не ошиблись в том, что аппаратное обеспечение дорого и сложно в разработке;* производители консолей часто компенсируют затраты на оборудование за счет продаж программного обеспечения, когда они владеют витринами магазинов и получают долю со всего, что продается в цифровом виде (часто 30%).

Поскольку Meta и Steam доминируют в продажах программного обеспечения для виртуальной реальности на потребительском рынке, продажи программного обеспечения на самом деле не были жизнеспособным источником дохода для других производителей оборудования, поэтому HTC переключается на корпоративное оборудование с более высокими ценами, потенциально получая более прибыльную прибыль от своих цифровых корпоративных услуг. и модель потребительской подписки Viveport.

*Это может объяснить, почему контроллеры движения Wand и Index по-прежнему являются единственным выбором для SteamVR,* несмотря на то, что Vive был запущен для потребителей еще в 2016 году. Контроллеры Etee и Pimax Sword для SteamVR долго откладывались, в то время как другие попытки приходили и уходили без дальнейших следов.

![[Pasted image 20220221074357.png]]

*Компоненты отслеживания SteamVR значительно увеличивают стоимость материалов* по сравнению с решениями на основе камер и алгоритмов, но у вас нет выгодного программного обеспечения для продажи, чтобы компенсировать затраты на оборудование. Я считал контроллеры Valve Index очень разумной ценой в 129,50 фунтов стерлингов каждый (259 фунтов стерлингов за пару с бесплатной доставкой), учитывая безумный уровень сложности и огромное количество датчиков, упакованных в каждое устройство.

Поскольку LG брала с меня 60 фунтов стерлингов за простой пульт дистанционного управления для телевизора, производимый в массовом масштабе, было трудно понять, получает ли Valve какую-либо прибыль, продавая свои контроллеры Index? Их канал продаж «бизнес-потребитель» (B2C) исключал любых посредников и их маржу, что отчасти подтверждало это наблюдение. Поскольку Valve зарабатывает деньги на продаже программного обеспечения, возможно, Индекс покрывал свои расходы, но не особенно прибыльно, поскольку на самом деле в этом не было необходимости.

Говорят, что *аппаратное обеспечение — это просто система доставки отличного контента* и неизбежное зло во многих отношениях, с которым многие предпочли бы, чтобы кто-то другой разобрался. Как Самнер Редстоун неоднократно говорил о телевизионных программах во время своего руководства Viacom: «Контент — это король!»

# Время для моей проверки реальности
Откровенные обсуждения с наставником (у которого есть портфолио патентов и опыт вывода продуктов на рынок) привели к тому, что мы рассмотрели предполагаемые затраты на установку, потенциальные объемы продаж на основе наиболее известных данных, текущие глобальные риски для поставок и производства, растущие транспортные расходы.

Опытные игроки с глубокими карманами действительно боролись с продолжающейся неопределенностью, в то время как на моей реальной работе мы наблюдали месяцы задержек со складскими запасами и гарантийными заменами, усугубляемые постоянными проблемами контроля качества, вызванными дефектами сторонних компонентов или ошибками заводской сборки; все изо всех сил пытались вытащить вещи, а некоторые вещи приходили сломанными.

Мы также рассмотрели, *как быстрый рост платформы [Meta Quest](https://skarredghost.com/2020/10/17/oculus-quest-2-review/) откачивал деньги на разработку программного обеспечения и, следовательно, будущий интерес потребителей от использования оборудования SteamVR,* в то время как Valve сохраняла свое обычное радиомолчание, мало говоря о виртуальной реальности с момента запуска HLA.

[Ютубер Брэдли Линч (Sadly It Bradley)](https://www.youtube.com/c/SadlyItsBradley/videos) провел кропотливое исследование, подтвержденное Ars Technica с использованием контактов в Valve, новой системы виртуальной реальности Valve под названием «Deckard». Крупный транш патентов был выпущен ранее в этом году после прекращения судебного процесса против поставщика оптики, в который они вложили 9 миллионов долларов еще в 2018 году.

![[Pasted image 20220221075207.png]]

Но, как и во всех этих вещах: всего лишь судебный иск, несколько патентов на бортовую обработку, поляризационную оптику и различные ремешки для головы, несколько утечек кода, содержащих отсылки к Декарду, но радиомолчание со стороны Valve (ничего необычного здесь тогда), *хайп-трейн покинул станцию и уехал …Steam* (извините!)

Сообщество виртуальной реальности продолжало ждать каких-либо дальнейших новостей о преемнике Index: панели дисплея BOE 2017 года давно пора обновить, а *некоторые улучшенные джойстики и беспроводной модуль 802.11ay были бы действительно оценены многими.*

К сожалению, *наши цифры по производству нового контроллера SteamVR просто не сошлись,* у меня уже было сильное подозрение, что это так, но мне нужно было услышать это от кого-то с большим опытом. После моего приветствия в реальности я поблагодарил своего наставника и *закрыл свое маленькое предприятие, прежде чем потратил больше собственных денег.*

# XRCaliper
Я уже получил слишком много удовольствия, чтобы полностью бросить это дело, и *решил просто начать создавать забавные штуки в более спокойном темпе*, так как я уже пару месяцев сжигал масло по ночам.  
  
Почему бы не дать ему имя, так XRCaliper это было. Я создал простой сайт www.xrcaliper.com и аккаунт в Твиттере [@XRCaliper](https://twitter.com/xrcaliper/), чтобы общаться со всем миром.

![[Pasted image 20220221075938.png]]

В течение этого года я занимался различными областями разработки (отслеживание, эргономика, тактильные ощущения, механика, программное обеспечение и т. д.), что привело к созданию ряда «мулов» разработки, прежде чем приступить к работе над самим Caliper. Вот часть истории…

# Steamworks
После получения моего Tundra HDK в начале этого года моим вторым шагом было *зарегистрироваться в Steamworks в качестве лицензиата Valve* без каких-либо дополнительных затрат. Теперь я официально стал разработчиком SteamVR и мог создавать игры или оборудование для выпуска на платформе Steam.

*В соответствии с условиями лицензии мне не разрешено подробно обсуждать некоторые технологии,* но если кому-то из читателей интересно, ничто не мешает им также зарегистрироваться в Steamworks по этой ссылке: https://partner.steamgames.com.

Получение лицензии дало мне доступ к SteamVR Tracking HDK и Steam SDK, которые также содержали исходную документацию по учебному курсу SteamVR 2016 года, который проводился в течение нескольких лет совместно с партнером Valve Synapse в Сиэтле.

*Этот учебный курс стоил около 3000 долларов и был обязательным для всех, кто хотел использовать SteamVR.* Эта плата включала набор полезного эталонного оборудования для создания отслеживаемых объектов, которое также можно было разобрать и повторно использовать для создания прототипов.

![[Pasted image 20220221080307.png]]

Однако в 2017 году было принято решение отказаться от требований к курсу (он по-прежнему был доступен при необходимости) и *открыть бесплатные учебные материалы и примеры, чтобы стимулировать рост экосистемы SteamVR.*

Преимущество этого заключалось в резком снижении стоимости входа (3000 долларов за курс против 149,99 долларов за HDK без ключа), *отсутствии какой-либо прямой поддержки и зависимости от устаревших материалов курса* (базовые станции эволюционировали до версии 2.0, и внедрение системы ввода SteamVR) *означало, что с этой технологией было сложнее разобраться,* особенно для начинающего разработчика аппаратного обеспечения, такого как я.

# Tundra HDK RMA

Прочитав все, что можно, несколько раз и задом наперёд (на всякий случай), *я решил приступить к запуску Tundra HDK*. Это делается с помощью «Консоли маяка», которая представляет собой интерфейс командной строки со списком команд, используемых для идентификации, сопряжения, диагностики и т. д.
![[Pasted image 20220221080807.png]]

Я попытался подключить HDK к своему ПК, а затем соединить беспроводной модуль с беспроводным ключом Vive (USB), который я купил вместе с HDK (TL448K6D-GP-HDK с ключом за 179,99 долларов США). Беспроводная связь осуществляется в диапазоне 2,4 ГГц с использованием модифицированной версии платформы Nordic Enhanced Shock Burst.

Тем не менее, *у меня продолжали возникать проблемы с подключением*, когда HDK искал беспроводное соединение, всегда отказываясь от сопряжения. Обеспокоенный тем, что я сделал что-то не так, я просмотрел всю свою информацию и много раз пытался настроить ее, пробуя разные USB-порты для ключа и удерживая HDK рядом с ключом. HDK каждый раз подключался через USB, но просто не работал с беспроводным соединением.

Я связался с Тундрой, и после некоторого разговора *они сообщили, что это, вероятно, неисправность самого беспроводного модуля на HDK.* Tundra Labs принесла извинения и *организовала замену HDK, которую лично протестировал босс Tundra Люк Бено* (!). В течение недели у меня был совершенно новый Tundra HDK, а неисправный HDK остался у меня, так как отправлять его обратно в США было бессмысленно. В целом, это был отличный опыт обслуживания клиентов!

![[Pasted image 20220221081052.png]]

То, что изначально заставляло меня чувствовать себя немного аппаратным манекеном и временно приостанавливало работу, теперь предлагало бонусную возможность для дальнейшей работы с оборудованием. *Использование длинного USB-кабеля позволило бы мне продолжать использовать неисправный HDK с отслеживанием 6DoF, но привязанным к ПК вокруг рабочего стола.*

Теперь можно было построить:  
- *Проводной объект SteamVR*, использующий неисправный HDK, для тестирования отслеживаемой объектной модели с одной базовой станцией в окружении рабочего стола. 
- *Беспроводной объект SteamVR*, использующий новый Tundra HDK, для тестирования прототипа рабочего контроллера с двумя базовыми станциями в среде Roomscale.

# Отслеживаемый объект
Я подумал, что мог бы повеселиться с моим отслеживаемым объектом, так как можно было напечатать на 3D-принтере эталонный дизайн (НЛО), использованный в учебном курсе SteamVR, но я предпочел пойти своим путем, полагая, что смогу узнать больше, начав с царапать. *Оглядываясь назад, вероятно, стоит сделать это по-своему, чтобы избавить себя от головной боли, если только вы не любите математику и хакерство*.

После того, как за последние 5 лет я использовал много разных контроллеров движения, часто вариаций на тему, я задался вопросом, есть ли другое решение. Почему они остановились на такой форме? Почему бы не попробовать что-то другое, *как насчет пистолетной рукоятки?* Вместо того, чтобы наращивать хватку, *я мог бы купить что-нибудь легкодоступное в Интернете*. Amazon продал мне формованную нейлоновую рукоятку для страйкбольной винтовки AR-15… пришло время приступить к *созданию моей первой разработки «Мул»*.

*«Мулы» — это испытательные стенды, часто оснащенные рабочими компонентами, позволяющими проводить непосредственную оценку на ранних стадиях разработки*. Они могут быть «глухими» — снабженными переключателями и джойстиками с механическим управлением, или «живыми» — с включенными входами и подключенными через GPIO (ввод/вывод общего назначения).

Теперь у меня был проводной HDK для тестирования отслеживаемого объекта и новый беспроводной HDK для возможного прототипа контроллера. *Мне понадобятся некоторые компоненты ввода, такие как кнопки, триггеры, трекпады, джойстики и, в конечном итоге, микроконтроллер* для их запуска, когда все будет подключено для прототипирования. Некоторые *тактильные двигатели и светоизлучающие диоды* также могут быть полезны для обеспечения обратной связи с контроллером.

# COTS спешит на помощь

Почему бы не использовать существующие детали, уже находящиеся в серийном производстве? *Использование компонентов COTS (готовых к продаже) может сэкономить огромное количество времени и денег по сравнению с использованием запатентованных компонентов*, изготовленных специально для данной конструкции с высокими затратами на установку. Как говорится в старой поговорке… нет смысла изобретать велосипед?

Углубившись в мир геймпадов, *я нашел несколько компаний, предлагающих «заменяемые» детали для своих продуктов*, некоторые нацелены на бюджетный сегмент рынка, хотя пара авторитетных крупных брендов нацелена на геймеров высокого класса.

*Геймпад X Pro E-Swap от Thrustmaster выглядел очень подходящим*, несмотря на возмутительную стоимость в 220 фунтов стерлингов с доставкой и налогами со склада владельца бренда Guillemot во Франции. В качестве бонуса *потребители могли легко получить доступ к процветающей экосистеме запасных частей* с наборами «hop-up», предлагающими различные входные компоненты, цвета, текстуры и стили.

**Этот геймпад модульный, состоит из легко заменяемых блоков**
![[Pasted image 20220221081912.png]]

Сменный модуль джойстика стоил менее 20 фунтов стерлингов, и *его можно было заменить на D-Pad или Touchpad, чтобы пользователь мог полностью настроить свои настройки*. Я также решил купить "синий комплект hop-up" за 40 фунтов стерлингов, который поставлялся со сменным джойстиком, крестовиной, парой боковых рукояток и парой накладок на триггеры.

Эта модульная конструкция сразу же принесла большую пользу: *можно было настроить левый контроллер с джойстиком, правый с тачпадом или, как вы хотели*, вы могли использовать D-Pad на обоих контроллерах, если очень хотели.

После нескольких недель задержек с доставкой (спасибо Brexit) прибыл мой геймпад Thrustmaster, и, без сомнения, это был красивый продукт. Прежде чем разобрать все это (!!), у меня было несколько сеансов виртуальной реальности в Project Cars 2, House of the Dying Sun и Aircar, чтобы проверить качество входных компонентов. Я не был разочарован: *триггеры, джойстики и кнопки были лучшими из тех, что я когда-либо пробовал*, а металлические джойстики заставляли мои другие геймпады и контроллеры движения VR чувствовать себя дешевыми игрушками по сравнению с ними.

*Система E-Swap использовала сильные магниты для удержания модулей* в специальных гнездах с подпружиненными контактами и работала очень хорошо, не ощущая свободного движения джойстика или крестовины. Thrustmaster включил программное обеспечение с назначением кнопок, настройками ввода E-Swap и полной настройкой джойстиков, *что заставило меня задуматься о программной поддержке будущего контроллера виртуальной реальности с аналогичным уровнем настройки*.

![[Pasted image 20220221082349.png]]

Однако все было не так радужно: *геймпад казался очень тяжелым* и немного маленьким в руках (из-за чего он пытался соскользнуть вниз), что усугублялось длинным плетеным USB-кабелем (он не был беспроводным), из-за чего геймпад чувствовал себя еще тяжелее, когда передвигаться.

Однако наиболее заметным, что сильно отвлекало в виртуальной реальности, были постоянные небольшие движения и щелкающие звуки от магнитных «боковых ручек» на корпусе контроллера. Захваты не очень хорошо совпадали со своими креплениями, а магниты были слишком слабыми, чтобы остановить какое-либо движение.

Я видел эту проблему раньше с гарнитурой Valve Index, в которой также использовались магниты для удержания лицевой прокладки — *лицевая прокладка нередко падала с гарнитуры, поскольку магниты должны были быть намного сильнее*.

Как платный игровой клиент, я бы отправил его обратно для возврата денег, но *я был больше заинтересован в том, чтобы вырвать его компоненты ввода*, поэтому пришло время разобрать геймпад Thrustmaster; Я занялся своими отвертками, режущими инструментами и паяльником. Было очень интересно изучать их изготовление и дизайн, я сделал много фотографий и сделал заметки.

![[Pasted image 20220221082621.png]]

Теперь, вооружившись блокнотом и ручкой, моим проводным Tundra HDK, головой, полной идей, коробкой, полной запасных частей ввода Thrustmaster, и рукояткой AR15, *я приступил к работе, пытаясь понять, как построить мой отслеживаемый объект*, который Я уже решил, что должен быть какой-то портативный контроллер.

# “Gungrip”

Это было сделано для того, чтобы выделить пространство, необходимое для джойстика, кнопок и триггера, предлагая 12-миллиметровую регулировку вперед / назад между рукояткой и джойстиком, *чтобы пользователь мог установить идеальное расстояние досягаемости в соответствии со своими руками. У него не было датчиков, только имитация сенсорной планки перед рукояткой*.

![[Pasted image 20220221083433.png]]

Удивительный триггер Thrustmaster X-Pro и джойстик S5 с регулируемым положением уже сделали его действительно крутым, несмотря на то, что он был просто тупым старым мулом. *Теперь, когда у меня было что-то приятное в руке*, мне нужно было решить, как интегрировать HDK, но для этого мне нужно было дополнительное пространство, поэтому я временно отказался от джойстика.

# “T-Bar”

*Это было быстро создано, чтобы понять любые практические проблемы работы с HDK, в частности размещение датчиков и управление гибкостью*. Точное определение «центроида» датчика было сложной задачей; Я использовал несколько коммерческих клеев, пытаясь найти наилучшее решение, которое было бы стабильным, но не постоянным, поскольку я планировал удалить датчики в какой-то момент в будущем.

*HDK был установлен под основным корпусом, питался от большой перезаряжаемой литий-ионной батареи в быстросъемном креплении сзади*, поэтому я мог попробовать подключить батарею к HDK, хотя беспроводное соединение было мертво, требуя контроллера. подключен и питается через USB. Аккумулятор также уравновешивал вес передней направляющей, заставляя контроллер чувствовать себя нейтрально в рукоятке. В целом, он имел хороший вес, что делало его более похожим на настоящий пистолет.

![[Pasted image 20220221083728.png]]

*Это было подключено кабелем USB к консоли командной строки Lighthouse на моем ПК*, предоставляя данные IMU и попадания датчиков света для просмотра в режиме реального времени… было очень здорово увидеть это вживую и понять, что здесь что-то действительно происходит! Было приятно перемещать мой контроллер и наблюдать за реакцией на данные IMU или скрывать различные датчики, чтобы увидеть, как поток данных пропадает.

На данный момент никакие датчики не были сопоставлены с моделью, а IMU (гироскоп) не был откалиброван, поэтому данные были довольно случайными, но они были обнадеживающими в качестве отправной точки и позволили мне начать изучать, что делали различные команды консоли Lighthouse при тестировании отслеживаемых. объекты. Некоторые примеры команд:
```
identifycontroller: инициируйте тактильные импульсы на активном серийном номере, чтобы идентифицировать его  
imu: Переключить сброс пакетов данных IMU  
imusstats: Распечатать статистику IMU  
period: Распечатать статистику синхронизации
```
*Мул чувствовал себя очень сбалансированным в руке...* возможно, это был бы хороший выбор для использования в качестве контроллера-оружия в играх-стрелялках, таких как Pistol Whip? Интенсивная игра с оружием в течение нескольких недель в Pistol Whip проделала большую работу, треснув монтажную пластину рукоятки на моем правом контроллере Index, поэтому специальное периферийное устройство может быть очень кстати.

![[Pasted image 20220221084203.png]]

Большой тактильный двигатель, установленный внутри пустой рукоятки, обеспечит существенную обратную связь, а аккумулятор большой емкости обеспечит длительное время работы между зарядками.

Построенный с одним триггером для простого ввода, *я вскоре осознал ужасную сложность вычисления физических местоположений датчиков* и каким-то образом перевести их в трехмерный объект, который мне все еще нужно было изучить, чтобы даже начать строить, поэтому *перешел к гораздо более простая идее*.

# “Guncube”

После разборки Т-образного мула я попытался использовать несколько небольших картонных коробок, *прежде чем нашел правильный размер, чтобы использовать его в качестве основы для создания простого трекер куба*. Я провел измерения и разместил датчики в этих местах, чтобы приблизительно знать, где они расположены.

Коробка была тщательно заклеена лентой, чтобы максимально защитить поверхность от влаги или движения. Излишние изгибы для каждого датчика могли свободно висеть внутри коробки, избавляя от головной боли, связанной с прокладкой кабелей, прокладкой каналов или лентой снаружи.

**Ручка куба, датчики, установленные на картонном кубе, и внутренняя часть куба**
![[Pasted image 20220221084523.png]]

Это гарантировало наиболее реальный шанс построить что-то работающее, хотя вскоре я понял, что *мне нужно больше датчиков и, что важно, больше «некомпланарных» датчиков* (не все установлены на одной плоскости или поверхности), чтобы заставить его загружаться быстро и затем поддерживайте точное отслеживание 6DoF в диапазоне полезных углов взаимодействия.

Литература по курсу SteamVR содержала несколько замечательных советов по дизайну, поддерживающих использование граней для разделения поверхностей и использование большого расстояния между датчиками в одной плоскости (базовая линия); в идеале охватить объект несколькими датчиками под разными углами, как можно дальше друг от друга.

Однако мне действительно нужно было пройти через процесс разработки, даже устроив большой беспорядок, просто чтобы понять, что нужно, так что вот оно, проблемы с отслеживанием входящих сообщений или нет.

*Затем Скарредгхост предложил название «Guncube»*, которое звучало идеально, спасибо, Тони!

**Guncube. Название, конечно же, было вдохновлено приложением «The Unity Cube».**
![[Pasted image 20220221084935.png]]

После создания физической модели на этот раз я также построил базовую модель САПР и впервые использовал инструменты Valve SteamVR HDK для анализа размещения датчиков и более глубокого понимания процесса от начала до конца.

*Процесс начался с создания первой модели САПР*: я построил простую модель с кубом слежения и формой, представляющей объем рукоятки. *Я использовал бесплатное приложение, рекомендованное Valve, под названием OpenSCAD*, после изучения руководства, чтобы получить общее представление о том, как некоторые из них работают, поскольку оно использует текстовый язык:

```
OpenSCAD — это описательный текстовый язык программирования, который использует знакомый синтаксис, операторы if, циклы, переменные и арифметику для объединения простых геометрических примитивов в сложные объекты. https://programmingwithopenscad.github.io/
```
**Guncube внутри Openscad**
![[Pasted image 20220221085429.png]]
После создания объекта Guncube я создал простую CAD-модель оптических датчиков Triad TS4112, используемых в Tundra HDK. Сенсорная модель используется при размещении множества одинаковых сенсоров по поверхности объекта во время симуляции, чуть позже в процессе.

Сломанный датчик моего HDK показан ниже, *блестящая черная область — это «сенсорное окно», которое принимает входящий лазерный свет, проецируемый с базовых станций в среде SteamVR*. Эти датчики приклеиваются клеем или закрепляются механически (имеется небольшое установочное или монтажное отверстие), в то время как изгибы обычно крепятся внутри корпуса контроллера. В производственном оборудовании использовались нестандартные изгибы, чтобы уменьшить физическую упаковку и обеспечить более широкое распространение датчиков по всей конструкции.
**сенсор и расположение двух сенсоров на Valve Index**
![[Pasted image 20220221085918.png]]
При построении отслеживаемого объекта датчики располагаются снаружи корпуса, а на серийных контроллерах *оптические окна сделаны из специального фильтрующего пластика, пропускающего лазерный свет и сводящего к минимуму влияние видимого света и отражений*. Эти оптические окна были гордой особенностью дизайна гарнитур HTC Vive, но они гораздо более незаметны на оборудовании Index, что затрудняет их идентификацию. Два видны на изображении выше справа.

Следующим шагом было создание маски для ручки, чтобы *программа моделирования не пыталась разместить датчики на ручке* по понятным причинам! Маска была построена в другом цвете, чтобы сделать ее более заметной при установке ее положения относительно центра самой модели контроллера.
**Область ручки окрашена в серый цвет, потому что она не должна содержать датчиков**
![[Pasted image 20220221090241.png]]
