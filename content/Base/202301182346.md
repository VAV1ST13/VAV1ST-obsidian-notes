*ссылка*
https://godotengine.org/article/whats-missing-in-godot-for-aaa/
***
*перевод*
# Godot для разработки игр AA/AAA - Чего не хватает?
Скоро выйдет Godot 4.0. Она включает в себя значительные улучшения по всем направлениям в области функций, производительности и удобства использования. Тем не менее, один из самых больших вопросов, возникающих у сообщества, заключается в следующем: как это соотносится с основными коммерческими предложениями?

# Улучшения Godot 4.0
## Рендеринг
Godot 4.0 имеет совершенно новую архитектуру рендеринга, которая делится на современные и совместимые серверные части.  
  
Современный выполняет рендеринг через RenderingDevice 
(который будет реализован в таких драйверах, как Vulkan, Direct3D 12 и других в будущем). 
Кроме того, современный серверный сервер может реализовывать методы рендеринга, такие как прямой кластерный, мобильный и другие в будущем (например, отложенный кластерный, кинематографический и т.д.).  
  
Серверная часть совместимости основана на OpenGL ES 3.0 / OpenGL 3.3 / WebGL 2.0 и предназначена для работы на очень старом оборудовании ПК, а также на большинстве старых (все еще работающих) мобильных телефонов.

Рендеринг значительно более эффективен в Godot 4.0, используя алгоритмы, ориентированные на данные, для обработки выборки объектов и как вторичных командных буферов, так и автоматической пакетной обработки для эффективной отправки примитивов рисования.  
  
Предлагаемые функции также намного больше напоминают игры AAA, такие как гораздо больше вариантов материалов и продвинутых визуальных эффектов (включая circle DOF, volumetric fog, AMD FSR и т.д.). 
Кроме того, Godot 4.0 поддерживает передовые технологии глобального освещения, такие как lightmapping (включая SH lightmapping), Voxel GI (который полностью в режиме реального времени) и SDFGI (который представляет собой решение GI с открытым миром в один клик). Экранное пространство GI можно использовать для еще большего повышения реалистичности.

## Физика
После неудачной попытки использовать Bullet, Godot 4.0 возвращается к собственному физическому движку, который, несмотря на то, что не является высококлассным физическим движком, подобным PhysX, стремится предложить пользователям гораздо больше гибкости и возможностей “просто работает”.  
  
Начиная с версии 3.x в Godot Physics было добавлено несколько функций, таких как поддержка мягких тел и цилиндрической формы, а также несколько оптимизаций для использования нескольких потоков.

Пользовательский физический движок все еще имеет значительное количество проблем, но мы прилагаем все усилия, чтобы обеспечить его достойное состояние для доставки, когда 4.0 достигнет стабильности. Улучшения будут продолжаться и после этого, в течение следующих циклов выпуска 4.x.

Тем не менее, Godot 4.0 предоставляет возможность привязывать пользовательские физические движки во время выполнения (без перекомпиляции Godot) с помощью GDExtension, поэтому сообщество вполне может интегрировать другие движки, такие как PhysX, Jolt или Box2D, если это необходимо.

## Scripting
Godot 4.0 имеет новую версию GDScript, которая намного мощнее и устраняет большинство недостатков, обнаруженных в 3.x. 
В основном, добавление лямбд, функций/сигналов первого класса и значительно меньшая зависимость от строковых идентификаторов (которые подвержены ошибкам). Он также имеет более полезные встроенные типы данных, такие как целочисленные векторы.

## Core engine
Core engine было значительно оптимизировано, особенно в областях, ориентированных на память и данные. Core и Variant были значительно очищены и сделаны более расширяемыми. Помимо того, что базовая кодовая база стала быстрее и современнее, ее теперь значительно проще поддерживать и расширять.

## GDExtension
Благодаря новой системе GDExtension теперь можно расширять Godot и добавлять в него функции практически на любом языке и без перекомпиляции движка. Помимо Godot C++ (который упрощает расширение Godot так же просто, как с помощью модулей, но допускает подключаемые динамические дополнения), в работе есть и другие привязки, такие как Python, Rust, Go и т. д.

## A lot more
Несколько других областей получили улучшения, такие как редактор (который был значительно переработан), система пользовательского интерфейса, мультиплеер, навигация, аудио, анимация и т. д. Это крупный релиз с существенными улучшениями по всем направлениям.

## So, what’s missing?
Не заблуждайтесь: в Godot по-прежнему многого не хватает для комфортного использования в крупных проектах и командах. Тем не менее, теперь осталось гораздо меньше работы, чем было для Godot 3.x.

Прежде всего, большинство новых функций по-прежнему содержат значительные ошибки и проблемы с производительностью, которые не будут решены вовремя к предстоящему выпуску 4.0 (слишком много нового кода, который необходимо тщательно протестировать).

Эти проблемы будут исправлены в выпусках 4.x point (которые мы теперь намерены делать чаще, допуская несколько выпусков в год). Это может занять дополнительный год или даже два, пока все не станет таким прочным и быстрым, как все ожидают. Смотрите эту статью о наших планах на 4.0 и далее.

Но помимо этого, в Godot все еще отсутствуют некоторые фундаментальные аспекты. Ниже приведен неполный список наиболее важных из них:

## Streaming
Традиционный способ сделать игры длиннее с незапамятных времен - разделить их на этапы. 
Как только один этап завершен, он выгружается, пока загружается новый.  
  
Многие игры до сих пор используют этот подход (в конце концов, если он не сломан, не исправляйте его), но все чаще игровой дизайн переходит от “отдельных этапов” к “открытым” или “непрерывным” мирам, где границы между уровнями исчезают. В результате создание игр таким способом становится более сложной задачей.  
  
В настоящее время это решается с помощью технологии, называемой “потоковой передачей”. Это означает, что ресурсы извлекаются с диска по требованию (загружаются только в то время, когда они необходимы), а не как часть более крупного этапа. Наиболее распространенными типами потоковой передачи являются:

- *Texture streaming*: по умолчанию все текстуры загружаются в крошечном размере. По мере приближения текстур к камере с диска передаются версии с более высоким разрешением (или mip-карты). Вместо этого освобождаются текстуры, которые не использовались для некоторых кадров. В любой момент времени загруженные текстуры (и их детализация) точно отражают место, в котором находится игрок.
- *Mesh streaming*: модели загружаются с низкой детализацией (несколько вершин). По мере того как они постепенно приближаются к камере, с диска передаются версии с более высоким разрешением. Модели, которые некоторое время не использовались (не отображались), часто просто освобождаются и при необходимости загружаются снова.
- *Animation streaming*: Современные игры имеют длинную кинематографическую графику, которая требует большого количества анимационных данных. Загрузка этих анимаций требует много памяти, а их загрузка занимает много времени. Чтобы избежать этого, анимация транслируется в потоковом режиме, обычно сохраняя первую секунду или две в памяти, а затем новые разделы загружаются по требованию по мере воспроизведения анимации. Godot 4.0 поддерживает сильное сжатие анимации и анимацию страниц, поэтому большая часть работы уже выполнена.
- *Audio streaming*: Аналогично потоковой передаче анимации, для этого требуется сохранить первую или две секунды аудио, а затем транслировать остальное непосредственно с диска.

Из вышеперечисленного большинство относительно просто реализовать. Наиболее сложной является *mesh streaming*, которая обычно должна быть реализована вместе со стратегией отбора графических процессоров, чтобы гарантировать, что можно нарисовать очень большое количество моделей без затрат на процессор. Это более или менее то, что делают такие методы, как Nanite, в Unreal, хотя Godot не нужно реализовывать что-то настолько сложное, чтобы быть полезным в большинстве случаев.

Streaming - самая важная функция, которой не хватает для управления большими сценами или открытыми мирами. Без этого пользователи Godot будут подвержены длительному времени загрузки (так как каждая текстура, модель и анимация должны загружаться, прежде чем что-либо будет показано). Существует также риск нехватки памяти, если слишком много ресурсов загружается параллельно вместо их потоковой передачи.

## Low level rendering access
Несмотря на новый рендеринг в Godot 4.0, не существует архитектуры, которую можно было бы считать универсальным решением для всех. Часто разработчикам приходится внедрять методы рендеринга, эффекты постобработки и т.д., которые не поставляются в комплекте с движком.  
  
Философия Godot всегда заключалась в том, чтобы ориентироваться на решение наиболее распространенных вариантов использования и оставлять дверь открытой для пользователей, чтобы они могли решать менее распространенные самостоятельно.  
  
Таким образом, это означает, что низкоуровневый доступ ко всем структурам сервера рендеринга должен быть предоставлен через GDExtension. Это позволит создавать пользовательские средства визуализации или подключать пользовательский код на этапах рендеринга, что очень полезно для пользовательских методов рендеринга или постпроцессов.

## Scene job system
Большая часть работы, проделанной для Godot 4.0, включала значительные улучшения функций и производительности всех серверов (рендеринг, физика, навигация и т.д.). Серверы также теперь многопоточны и оптимизированы. Даже загрузка ресурсов теперь может выполняться многопоточно (с использованием нескольких потоков для загрузки нескольких ресурсов).  
  
Тем не менее, scene system (которая использует эти серверы), несмотря на несколько улучшений удобства использования, не претерпела существенной оптимизации.

Узлы сцен в Godot в основном предназначены для выполнения сложных высокоуровневых действий (таких как анимационные деревья, кинематические персонажи, ИК, скелеты и т.д.) для ограниченного количества объектов (не более сотен). 
В настоящее время потоковая передача вообще не происходит, и используется только одно ядро процессора. 
Это делает его очень неэффективным.  
  
Это делает его идеальной целью для оптимизации с помощью многопоточности. Существует первоначальное предложение по потоковой обработке для узлов сцены, которое должно дать сложным сценам очень значительный прирост производительности.

## Swarms
Сцены, как упоминалось ранее, предназначены для сложного высокоуровневого поведения в сотнях случаев. Тем не менее, иногда некоторые игры требуют большего количества экземпляров, но вместо этого менее сложного поведения.  
  
Это необходимо для некоторых типов игровых механик, таких как:  
  
- Projectiles (например, bullet hell).  
- Юниты в некоторых типах стратегических игр с тысячами объектов, перемещающихся по карте.  
- Автомобили/люди в городских симуляторах, где тысячи появляются по всему городу.  
- Sandbox style симуляции.  
- Complex custom particles, которые выполняются на CPU.  
- Стаи, рои, толпы мобов, обломки и т. д.  
  
Более опытные программисты могут использовать серверы напрямую или даже подключать код на C++ для выполнения тяжелой работы. ECS часто также предлагается в качестве решения этой проблемы. Даже вычисления на GPU (которые полностью поддерживаются в Godot) можно легко использовать для решения этой проблемы.

Но ради того, чтобы Godot был доступным и простым в использовании, идея состоит в том, чтобы создать систему swarm, которая заботится о рендеринге/физике/и т. д. В большом количестве этих объектов, и пользователю нужно только заполнить логику кода.

## Large team VCS support
Форматы текстовых файлов Godot очень удобны для контроля версий. Они пишут только то, что необходимо (никакой избыточной информации), сохраняют порядок разделов и достаточно просты, чтобы понять изменения, просто взглянув на разницу. Немногие другие технологии работают так же хорошо в этой области.

Несмотря на это, этого далеко не достаточно для обеспечения совместной работы большой команды. Для этого необходимо улучшить поддержку VCS Godot в нескольких областях:

- Улучшенная интеграция с док-станцией файловой системы.  
- Лучшее обновление активов в режиме реального времени, если они были изменены извне (и извлечены).  
- Поддержка разрешений и блокировки файлов: Git не поддерживает это из коробки, но Git LFS и Perforce поддерживают. Эта функция необходима для больших команд, чтобы избежать конфликтов и защитить файлы от непреднамеренных изменений (например, член команды по ошибке изменяет код или сцену, которой он не владеет).

Если для этого не будет надежной поддержки, использовать Godot в больших командах будет по-прежнему сложно.

## Commercial asset store
В то время как для очень крупных студий это не представляет интереса, студии среднего размера по-прежнему полагаются на значительные ресурсы и готовые функциональные возможности. Библиотека ресурсов, существующая в настоящее время в Godot, ссылается только на ресурсы с открытым исходным кодом (например, размещенные на GitHub или GitLab) и не может использоваться для коммерческих ресурсов.  
  
Для проекта Godot коммерческое хранилище активов было бы отличным способом добавить дополнительный источник дохода, но до недавнего времени это было невозможно с точки зрения закона, учитывая наш правовой статус. С переходом в [Godot Foundation](https://godotengine.org/article/godots-graduation-godot-moves-to-a-new-foundation) это открывает новые возможности.

# Достаточно ли решения этих проблем, чтобы Godot стал лучшим игровым движком AA/AAA?
Ответ: “это зависит от обстоятельств”. Godot, по своей сути, является и всегда будет (по замыслу) игровым движком очень общего назначения. Это означает, что предоставленные инструменты, несмотря на их несомненную эффективность, по-прежнему нейтральны к игре. Цель Godot - предоставить отличный набор строительных блоков, которые можно использовать и комбинировать для создания более специализированных игровых функций и инструментов.  
  
В отличие от этого, другие типы игровых движков уже поставляются с большим количеством высокоуровневых и готовых к использованию компонентов и поведений.  
  
Я не хочу сказать, что Godot не должен поддерживать ничего из этого в будущем. Однако, если это произойдет, то, скорее всего, это будет официальное расширение.

Итак, о каких функциях мы говорим? Что ж..

## Игровые шаблоны и модели поведения, специфичные для конкретной игры
Например, Unreal поставляется с player controller, environment controller и множеством инструментов для управления темпом и ходом игры. Скорее всего, нацелен на игры TPS/FPS, которые являются самым популярным типом игр, созданных на этом движке.

Некоторые из них можно найти в виде шаблонов в библиотеке ресурсов Godot, но они и близко не подходят к этой функциональности. В конце концов, должны быть созданы официальные, более мощные и полные.

## Visual scripting
Хотя в прошлом у Godot были визуальные сценарии, мы обнаружили, что внедренная нами форма на самом деле не соответствует потребностям сообщества, поэтому она была прекращена.  
  
Что мы поняли, так это то, что визуальные сценарии действительно великолепны в сочетании с заранее разработанным поведением, упомянутым в предыдущем разделе. Без значительного количества доступных высокоуровневых поведений визуальные сценарии громоздки в использовании, поскольку требуют много работы для достижения простых целей сами по себе.  
  
Все это означает, что, если мы снова создадим визуальное скриптовое решение, оно должно идти рука об руку с высокоуровневым поведением и, как таковое, должно быть частью набора расширений движка.

## Специализированные пользовательские интерфейсы художников
При выполнении таких задач, как редактирование шейдеров, VFX (частицы) или анимация, существует большая разница между Godot и движками, такими как Unreal.  
  
Разница заключается не столько в поддерживаемых функциях. На самом деле, набор функций довольно похож! Основное фактическое различие заключается в том, как они представляются пользователю.  
  
Godot - это очень модульный игровой движок: это означает, что вы достигаете результатов, комбинируя то, что есть. Например, редактирование системы частиц в Godot означает, что множество подсистем должны быть поняты и использоваться в сочетании:  
  
- GPUParticles node.  
- GPUParticlesMaterial ресурс (или даже дополнительный выделенный шейдер).  
- Mesh resource для каждого прохода particle.  
- Mesh material resource для каждой поверхности mesh (или даже дополнительный выделенный шейдер).  
  
В качестве другого примера, AnimationTree в Godot требует, чтобы AnimationNodes были расположены в виде дерева. Они могут экспортировать параметры, разделы можно использовать повторно (поскольку они являются ресурсами) и т. д.  
  
Или даже больше. Систему анимации Godot часто хвалят, потому что анимировать можно все, что угодно. 
Любое свойство, другие узлы и т.д.

Это делает Godot чрезвычайно мощным движком, который дает разработчикам большую гибкость, но…

Это также предполагает, что пользователь достаточно хорошо осведомлен о Godot и всех его внутренних механизмах, чтобы воспользоваться его преимуществами. Уточним, что ни одна из этих систем не является слишком технически сложной, и это часть того, что делает Godot привлекательным и доступным, но это все равно требует определенного уровня технических знаний и знаний двигателя.  
  
Напротив, движки, подобные Unreal, имеют полностью выделенные и изолированные интерфейсы для каждой из этих задач (материалы, кинематографическая временная шкала, VFX, анимация и т.д.).  
  
Конечно, они монолитны и, следовательно, менее гибки, но для большой команды с высокой специализацией художнику не нужно так глубоко разбираться в том, как работает движок, чтобы создавать контент с его помощью.  
  
Это показывает фундаментальную разницу целевого пользователя между движками. Если Godot хочет привлечь более крупные студии, ему необходимо предоставить более простые и монолитные интерфейсы, чтобы художники могли выполнять свою работу, не требуя значительных затрат времени на изучение технологии.  
  
Это, опять же, может быть предоставлено через официальные дополнения и, как и в разделах выше, потребует значительного объема исследований, чтобы понять, как его создать, поскольку без реальной обратной связи от художников мы могли бы только догадываться, что нужно. Но вопрос здесь в том, стоит ли оно того?

## So, are we not even close?
Хотя цель этой статьи - показать, насколько важна оставшаяся работа, чтобы сделать предложение Godot более близким к предложениям в коммерческом сегменте, важно не забывать одну ключевую деталь:  
  
Godot - это бесплатное программное обеспечение с открытым исходным кодом. И как таковой, он может быть изменен кем угодно в соответствии с любыми целями.  
  
В настоящее время многие крупные студии имеют возможность создавать собственные собственные технологии. Тем не менее, поскольку аппаратное обеспечение становится все более и более сложным в разработке, они отказываются от него в пользу траты денег на уже существующие коммерческие технологические предложения.  
  
С другой стороны, Godot служит отличной платформой для развития, поскольку она уже решает подавляющее большинство проблем. В результате все больше и больше студий используют Godot в качестве основы для создания собственных технологий.  
  
Это беспроигрышная ситуация, поскольку она позволяет им сохранить свою свободу для инноваций и в то же время избежать дорогостоящих затрат на лицензирование технологий.  
  
Время покажет, как Godot перейдет от своего нынешнего состояния к чему-то более широко используемому крупными студиями, но с нашей стороны определенно потребуется значительно больше работы.

## Future
Я надеюсь, что эта статья сделала более очевидным, почему Godot является такой ключевой технологией для будущего игровой индустрии. Мы будем продолжать усердно работать над тем, чтобы все больше и больше частных лиц и компаний находили Godot полезным! Но нам нужна ваша помощь, чтобы это произошло, поэтому, пожалуйста, подумайте о [пожертвовании на проект](https://godotengine.org/donate ).