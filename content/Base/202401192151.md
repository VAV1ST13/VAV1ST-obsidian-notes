202401192151
***
[[(статья) VRROOM - уроки создания социальной платформы VR, которая заняла первое место в магазине VR]]
***
*Design your software*

На каждом этапе разработки, прежде чем начать что-либо делать, необходимо спроектировать то, что вы собираетесь построить. И это нужно делать на разных уровнях.

На более высоком уровне вы должны спроектировать конечную цель: например, когда мы создавали альфа-версию, мы представляли, какой она может быть. Но после того как вы получили это высокоуровневое представление, вы должны спуститься на один уровень ниже и начать проектировать различные части, из которых состоит приложение. Этой частью занимаются различные руководители отделов, относящиеся к своей области знаний:

-технический директор разрабатывает высокоуровневую программную и сетевую архитектуру приложения.
-UX-дизайнер разрабатывает пользовательский опыт, а также пользовательский интерфейс, если нет отдельного UI-дизайнера.
-Арт-директор пишет, каким должен быть графический стиль и настроение приложения.
-Звуковой дизайнер представляет, какие части опыта требуют аудио, какие должны быть звуковые эффекты и т. д..

Этот момент очень важен, потому что именно здесь начинается настоящая работа. Каждый руководитель отдела готовит работу для всех сотрудников и координирует свои действия с другими руководителями, чтобы убедиться, что конечный результат всей их работы слажен. Без этого начального этапа все бы просто начали работать и делать что-то без основополагающей согласованности, что привело бы к катастрофе. 

```
На каждом этапе разработки, прежде чем начинать что-то делать, необходимо спроектировать то, что вы собираетесь построить.
Это нужно делать на разных уровнях.

На более высоком уровне нужно спроектировать конечную цель.
После того как мы получили высокоуровневое представление, мы должны спуститься на 1 ур. ниже и начать проектировать различ. части, из которых сост. приложение.
Этой частью занимаются руководители отделов, относящиеся к своей обл. знаний:

-техн. директор
(разраб. высокоуровневую программную и сетевую архитектуру приложения)
-UX-дизайнер
(разраб. пользовательский опыт, пользовательский интерфейс, если нет отдельного UI-дизайнера)
-Арт-директор
(пишет, каким должен быть графический стиль и настроение приложения)
-Звуковой дизайнер
(представляет какие части опыта треб. аудио, какие должны быть звуковые эффекты и т. д..)

Здесь начинается настоящая работа. 
Каждый руководитель отдела готовит работу для всех своих сотрудников и координирует свои действия с др. руководителями, чтобы убедится, что конечный результат всей их работы слажен.

Без этого начального этапа все бы просто начали работать без согласованности, что привело бы к катастрофе.
```

За свою карьеру разработчика программного обеспечения я понял, что самая ценная работа - это та, которую вы делаете до того, как начинаете писать код. Написание кода - это самостоятельный навык, но в конечном итоге это довольно механическая работа, и мы видим, как ChatGPT уже может частично заменить разработчиков для простых задач. Что возвышает нас над машинами, по крайней мере пока, так это способность к архитектуре кода, понимание от высокого уровня к низкому, как все взаимосвязано и как должно быть спроектировано, чтобы конечное приложение было модульным, эффективным и поддерживаемым. Это своего рода техническое искусство, требующее видения всего программного обеспечения, а также всех отделов, поэтому пока оно вряд ли может быть воспроизведено машиной. ChatGPT в конце концов достигнет этого, но, на мой взгляд, на это потребуются годы, в то время как для скучной задачи написания кода это уже почти достижение. 

Я говорю о программных архитектурах, потому что это моя задача как технического директора, но аналогичные рассуждения справедливы для любого отдела: Midjourney может делать интересные рисунки, но AI все равно не идеален для разработки графического стиля большого проекта. Если говорить о графическом стиле VRROOM, то его разработка была сложной задачей сама по себе. Я разговаривал об этом с нашим арт-директором Лапо Джермаси, и он объяснил мне одну ключевую сложность своей задачи: "Как определить графический стиль платформы, где пользовательский контент будет иметь свой стиль, и каждый его фрагмент будет отличаться от других?". Он также сказал мне, что каждый выбор, который он мог сделать, мог иметь эффект пульсации: например, выбор очень сильного стиля для аватаров и нашего домашнего окружения, вероятно, заставил бы всех создателей стремиться выбрать похожий стиль для своего опыта, чтобы сделать его целостным. Таким образом, это неявно ограничило бы их творческую свободу, а это не то, чего мы хотели. По этой причине он склонился к чему-то более "нейтральному", чтобы каждый создатель мог чувствовать себя свободнее, определяя свой стиль в опыте (вы все еще можете увидеть это в уютном стиле нашего домашнего пространства).

Возвращаясь к своей работе, я должен был решить, какие технические основы будут заложены в нашу платформу. Я выбрал Unity в качестве игрового движка, потому что он один из лучших, я умею им пользоваться, у него отличное сообщество, которое может поддержать вас в случае проблем, а еще это первый движок, который будет совместим с гарнитурами XR, когда они появятся: Apple сама говорила о Unity во время анонса Vision Pro. Для мультиплеера я также выбрал один из золотых стандартов индустрии: Photon, который со своим последним продуктом Fusion также значительно увеличил количество людей, разрешенных для одного инстанса/шарда (до 200). Unity XR и Unity XR Interaction Toolkit должны были стать основой всего, что связано с XR, поскольку они обеспечивают кросс-платформенную интеграцию XR-взаимодействий между всеми гарнитурами. Иногда XR Interaction Toolkit может показаться ограниченным по сравнению с некоторыми альтернативами, но тот факт, что это стандартное и кроссплатформенное решение, делает его привлекательным. Например, интеграция Meta Quest Unity предлагает потрясающие расширенные возможности, но они доступны только для Quest, поэтому команде пришлось бы писать собственный код взаимодействия для всех разных гарнитур, а у нас не было на это времени. Некоторые плагины Unity в Asset Store являются кроссплатформенными и предлагают очень реалистичные взаимодействия в XR, но их поддерживает один человек, и для нас было бы рискованно основывать фундамент нашей огромной платформы на одном человеке, который в любой момент может решить прекратить работу. Unity XR был гораздо более безопасным выбором.

```
Техн. основы нашей платформы:
-Unity (игровой движок)
-Photon (мультиплеер)
(послед. продукт Fusion значительно увелич. колич. пользователей в инстансе до 200)
-Unity XR и Unity XR Interaction Toolkit
(основа всего, что связано с XR)
(он может показаться ограниченным по сравнению с альтернативами, но это стандартное кросплатформенное решение)
прим. интеграция Meta Quest Unity предлагает расширенные возможности, но они доступны только для Quest, 
команде пришлось бы писать собственный код взаимодействия для всех разных гарнитур.
некоторые плагины Unity в Asset Store являются кроссплатформенными и предлагают очень реалистичные взаимодействия в XR, 
но их поддерживает один человек (это рисковано, т. к. он может в любой момент может прекратить работу)
Unity XR более безопасный выбор.
```

Я хочу сделать небольшой акцент на Photon Fusion и 200 человек в одном экземпляре: в идеале, в платформе для проведения концертов вы хотели бы иметь тысячи людей в одном экземпляре, чтобы воссоздать ту же ситуацию, которая происходит в реальной жизни с концертами на стадионах, где множество людей встречаются и поют вместе. Но сейчас сделать это практически очень сложно, потому что технология еще не готова. Прежде всего, это проблемы сетевого взаимодействия: каждый аватар должен обмениваться информацией о своей позе со всеми остальными компьютерами, а это создает огромный обмен данными. С помощью многочисленных оптимизаций на Photon можно собрать до 200 человек, что, конечно, неплохо, но все же не те тысячи, на которые мы рассчитываем. Хуже того, есть еще и проблема визуальной производительности: даже если бы вокруг вас было 200 человек, скорее всего, Quest 2 не смог бы показать все эти аватары во весь рост без проблем с производительностью. Поэтому сейчас мы ориентируемся на безопасные 20-40 аватаров на экземпляр, планируя со временем увеличить это число, оптимизируя производительность как сетевую, так и визуальную. В будущем мы можем даже подумать об использовании таких решений, как RP1, которые показали во время тестов, что они могут поддерживать тысячи и тысячи людей вместе в VR.

```
О Photon Fusion и 200 пользователей в одном инстансе.

В идеале, платформа для проведения концертов должна поддерживать одновременно тысячи людей.
Но сейчас сделать это практически очень сложно, технология ещё не готова.

Прежде всего это проблемы сетевого взаимодействия:
каждый аватар должен обмениваться информацией о своей позе со всеми остальными ПК, это создает огромный обмен данными.
С пом. различных оптимизаций Photon может собрать 200 пользователей.

Есть еще проблема в визуальной производительности:
если вокруг нас было бы 200 человек, скорее всего Quest2 не смог бы показать все эти аватары во весь рост без проблем с производительностью.
Поэтому мы сейчас ориентируемся на 20-40 аватаров на инстанс, со временем увеличив это число, 
оптимизируя сетевую и визуальную производительность.

В будущем возм. мы подумаем об исп. решения RP1, 
которые показали что могут поддерживать одновременно тысячи пользователей в VR. 
```

Разработка такого программного обеспечения - это вопрос компромисса между различными факторами. Выбор в пользу полнотелых VR-аватаров - один из них: хорошо иметь аватары с ногами, но это означает нагрузку на производительность, поскольку инверсный IK для расчета положения ног требует затрат, а также показ аватаров с ногами требует вычислительных затрат. Но мы оценили, что готовы немного пожертвовать производительностью, чтобы иметь аватары, которые лучше чувствуются. Этап разработки полон таких компромиссов.

```
Разработка софта - это вопрос компромисов между различными факторами.
Выбор полнотелых аватаров - один из них:
хорошо иметь аватары с ногами, но это означает нагрузку на производительность, т. к. инверсный IK для расчета положения ног треб. затрат.
показ аватаров с ногами треб. вычислительных затрат.
```

У нас также было несколько дискуссий о том, идти или не идти по веб-пути. Я очень верю в Web XR, я считаю, что в конечном итоге Метавселенная должна иметь сильную веб-компоненту. Веб делает опыт доступным с любого устройства, начиная с простого URL: это удобно, быстро и универсально. Проблема в том, что в настоящее время все системы разработки для WebXR очень грубы, а получаемая в результате графика WebXR-приложений обычно не впечатляет. Пообщавшись с художниками, мы решили, что, хотя это и заманчиво в будущем, в настоящем переход на путь WebXR принес бы нам много головной боли, чтобы получить конечный визуальный результат, который не был бы так хорош для наших пользователей. Мы делаем VR-концерты, причем довольно крутые, и очень важно обеспечить им правильный графический уровень, так что на данный момент переход на веб не дал бы нашим пользователям того, что мы хотели им дать. Мы все еще следим за тем, что происходит в веб-версии, чтобы оценить, стоит ли переходить в будущем.

```
У нас было неск. дискуссий, идти по веб-пути?
Я верю в WebXR, и что Метавселенная должна иметь сильную веб-составляющую.
Веб делает опыт доступным с любого устройства, начиная с простого URL: это удобно, быстро и универсально.

Проблема:
в настоящее время все сист. разработки WebXR очень грубы, а получаемая в результате графика WebXR-приложений не впечатляет.
мы решили, что это заманчиво в будущем, в настоящем переход на WebXR принес бы много головной боли, 
чтобы получить достаточно хороший визуальный конечный результат.
```

Облачная трансляция тоже была вариантом, но это привело бы к большим затратам (потоковое видео довольно дорогое), поэтому пока мы решили отказаться от нее.

```
Облачная трансляция привела бы к большим затратам (потоковое видео довольно дорогое), 
поэтому мы отказались от этого.
```

Когда я был молод, я думал, что люди, разрабатывающие программное обеспечение, - это просто гении с длинными бородами, которые входят в состояние транса, а затем, вдохновленные каким-то богом, пишут всю структуру проекта. На самом деле все гораздо иначе, может быть, потому, что моя борода только среднего размера: написание архитектуры - это итеративный процесс: вы обычно пишете ее, а затем пересматриваете и улучшаете в последующие дни. К тому же его должны оспаривать ваши коллеги, которые указывают на проблемы, которые вы должны исправить. Это также требует экспериментов: для всего, в чем я не был уверен, что нужно делать, мне приходилось тратить некоторое время на тестирование и эксперименты с моими предположениями. Это важно для кодинга, но еще важнее для UX: помните, что в XR нет стандартов взаимодействия, поэтому сложно разработать, как заставить пользователя делать что-то естественным образом, не проведя множество экспериментов с этим, и не попросив разных людей в команде протестировать прототипы и дать дизайнеру свои впечатления.

```
написание архитектуры - это итеративный процесс:
вы пишете её, а затем пересматриваете и улучшаете в последующие дни.
его должны оспаривать ваши коллеги, которые указывают на проблемы, которые вы должны исправить.
это также треб. экспериментов:
для всего в чем не был уверен, приходилось тратить некоторое время на тестирования и эксперименты с предположениями.
это важно для кодинга, и ещё важнее для UX:
в XR нет стандартов взаимодействия, поэтому сложно разработать, как заставить пользователя делать что-то естественным образом, не проводя множество экспериментов с этим, и не попроси разных людей в команде протестировать прототипы и дать дизайнеру свои впечатления.
```

Аудио и UX обычно являются забытыми детьми на этапе проектирования. Мы всегда думаем о визуальной составляющей, и, на самом деле, говоря о гарнитуре, мы всегда говорим о разрешении и FOV, в то время как аудио - это тоже очень важный компонент. Некоторые люди в Голливуде говорят, что звук составляет 50 % результата фильма: представьте, как звук может усилить напряжение, например, в фильме ужасов. Для нас, работающих с VR-концертами и шоу, звук становится еще более актуальным, чем для других, и наш генеральный директор Луис Каччуттоло всегда поднимает тему качества звука во время встреч. Вот почему так важно иметь в команде аудиодизайнера и/или несколько аудиоинженеров.

```
Аудио и UX забываются на этапе проектирования.
Для VR-концертов, звук является важной составляющей. 
Поэтому важно иметь в команде аудиодизайнера и/или неск. аудиоинженеров.
```

UX - это еще одна область, которую многие команды упускают из виду, но на самом деле она имеет огромное значение. UX-дизайнер в команде может увидеть опыт с точки зрения пользователя и представить, каким будет наилучший поток для него/нее для всего, что должно делать приложение. Это делает разницу между приятным опытом и тем, который едва ли можно использовать. Наличие в штате UX-дизайнера, который знает, как делать XR-опыт, крайне важно, и, к счастью, у нас есть наш замечательный Майк, который может творить чудеса. Наш UX-дизайнер создал эскизы пользовательского интерфейса, реализовал прототипы для каждой функции, которую нужно было разработать, и написал множество документов с техническими требованиями для разработчиков. Когда мы начали разработку VRROOM, мы еще не нашли UX-дизайнера, поэтому мы просто начали с временных идей, которые были у меня... а потом, когда появился Майк, выяснилось, что все они были не так уж хороши... поэтому нам пришлось переделать часть разработки, чтобы исправить поток, используя его опыт. UX-дизайнеры должны делать свою работу до начала разработки, иначе потом вам придется все переделывать, когда появится реальный дизайн.

```
UX - область, которую многие команды упускают из виду, но оно имеет огромное значение.
UX-дизайнер может увидеть опыт с точки зрения пользователя.
Наличие UX-дизайнера, который знает как делать XR-опыт, крайне важно.
Наш UX-дизайнер создал эскизы пользовательского интерфейса, реализовал прототипы для каждой функции и написал множество документов с техн. треб. для разработчиков. 
UX-дизайнеры должны делать свою работу до начала разработки, иначе потом придется все переделывать, когда появится реальный дизайн.
```